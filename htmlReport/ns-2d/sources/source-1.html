


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > SyncPendingOperationsWorker</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.example.eventmanagement.workers.sync_pending_operarions</a>
</div>

<h1>Coverage Summary for Class: SyncPendingOperationsWorker (com.example.eventmanagement.workers.sync_pending_operarions)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SyncPendingOperationsWorker</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/145)
  </span>
</td>
</tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$addToFirebase$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$addToFirebase$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$addToFirebase$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$addToFirebase$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$deleteFromFirebase$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$deleteFromFirebase$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$deleteFromFirebase$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$deleteFromFirebase$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$deleteOperation$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$doWork$1</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$doWork$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/11)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$updateFirebase$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$updateFirebase$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$updateFirebase$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$updateFirebase$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$updateFirebase$6</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$updateFirebase$7</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$updateFirebase$8</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$updateFirebase$9</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SyncPendingOperationsWorker$WhenMappings</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/30)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/301)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.example.eventmanagement.workers.sync_pending_operarions
&nbsp;
&nbsp;import android.content.Context
&nbsp;import android.util.Log
&nbsp;import androidx.hilt.work.HiltWorker
&nbsp;import androidx.work.CoroutineWorker
&nbsp;import androidx.work.ExistingWorkPolicy
&nbsp;import androidx.work.OneTimeWorkRequest
&nbsp;import androidx.work.WorkManager
&nbsp;import androidx.work.WorkerParameters
&nbsp;import com.example.eventmanagement.models.OperationType
&nbsp;import com.example.eventmanagement.models.PendingOperations
&nbsp;import com.example.eventmanagement.repository.firebase.events_data.EventDataMethods
&nbsp;import com.example.eventmanagement.repository.firebase.invites_data.InviteMethods
&nbsp;import com.example.eventmanagement.repository.firebase.user_data.UserDataMethods
&nbsp;import com.example.eventmanagement.repository.room_db.Converters
&nbsp;import com.example.eventmanagement.repository.room_db.PendingOperationDao
&nbsp;import com.example.eventmanagement.repository.room_db.attendee_dao.AttendeeDao
&nbsp;import com.example.eventmanagement.repository.room_db.events_dao.EventDao
&nbsp;import com.example.eventmanagement.repository.room_db.fav_events_dao.FavEventsDao
&nbsp;import com.example.eventmanagement.repository.room_db.invites_dao.InvitesDao
&nbsp;import com.example.eventmanagement.repository.room_db.user_dao.UserDao
&nbsp;import com.example.eventmanagement.receivers.ConnectivityObserver
&nbsp;import com.example.eventmanagement.utils.PreferencesUtil
&nbsp;import com.example.eventmanagement.workers.sync_data_from_firebase.SyncAttendeeDataWorker
&nbsp;import com.example.eventmanagement.workers.sync_data_from_firebase.SyncEventsDataWorker
&nbsp;import com.example.eventmanagement.workers.sync_data_from_firebase.SyncFavEventsDataWorker
&nbsp;import com.example.eventmanagement.workers.sync_data_from_firebase.SyncInvitesDataWorker
&nbsp;import com.example.eventmanagement.workers.sync_data_from_firebase.SyncUserDataWorker
&nbsp;import dagger.assisted.Assisted
&nbsp;import dagger.assisted.AssistedInject
&nbsp;import kotlinx.coroutines.CoroutineScope
&nbsp;import kotlinx.coroutines.Dispatchers
&nbsp;import kotlinx.coroutines.launch
&nbsp;import kotlinx.coroutines.withContext
&nbsp;
&nbsp;@HiltWorker
&nbsp;class SyncPendingOperationsWorker @AssistedInject constructor(
&nbsp;    @Assisted context: Context,
&nbsp;    @Assisted workerParams: WorkerParameters,
<b class="nc">&nbsp;    @Assisted private val userDao: UserDao,</b>
<b class="nc">&nbsp;    @Assisted private val eventDao: EventDao,</b>
<b class="nc">&nbsp;    @Assisted private val invitesDao: InvitesDao,</b>
<b class="nc">&nbsp;    @Assisted private val attendeeDao: AttendeeDao,</b>
<b class="nc">&nbsp;    @Assisted private val favEventsDao: FavEventsDao,</b>
<b class="nc">&nbsp;    @Assisted private val pendingOperations: PendingOperationDao,</b>
<b class="nc">&nbsp;    @Assisted private val connectivityObserver: ConnectivityObserver,</b>
<b class="nc">&nbsp;    @Assisted private val converters: Converters,</b>
<b class="nc">&nbsp;    @Assisted private val userDataMethods: UserDataMethods,</b>
<b class="nc">&nbsp;    @Assisted private val inviteMethods: InviteMethods,</b>
<b class="nc">&nbsp;    @Assisted private val eventDataMethods: EventDataMethods,</b>
<b class="nc">&nbsp;    @Assisted private val preferencesUtil: PreferencesUtil</b>
<b class="nc">&nbsp;) : CoroutineWorker(context, workerParams) {</b>
&nbsp;
&nbsp;    override suspend fun doWork(): Result {
<b class="nc">&nbsp;        return withContext(Dispatchers.IO) {</b>
<b class="nc">&nbsp;            try {</b>
<b class="nc">&nbsp;                Log.d(&quot;SyncPendingOperations&quot;, &quot;doWork: SyncPendingOperationsTriggered&quot;)</b>
<b class="nc">&nbsp;                val operations = pendingOperations.getAll()</b>
<b class="nc">&nbsp;                Log.d(&quot;SyncPendingOperations&quot;, &quot;doWork: $operations&quot;)</b>
<b class="nc">&nbsp;                for (operation in operations) {</b>
<b class="nc">&nbsp;                    if (connectivityObserver.isConnected) {</b>
<b class="nc">&nbsp;                        performOperationOnFirebase(operation)</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        performOperationLocally(operation)</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                Result.success()</b>
<b class="nc">&nbsp;            } catch (e: Exception) {</b>
<b class="nc">&nbsp;                Result.retry()</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private suspend fun performOperationOnFirebase(operation: PendingOperations) {
<b class="nc">&nbsp;        when (operation.operationType) {</b>
<b class="nc">&nbsp;            OperationType.ADD -&gt; addToFirebase(operation)</b>
<b class="nc">&nbsp;            OperationType.UPDATE -&gt; updateFirebase(operation)</b>
<b class="nc">&nbsp;            OperationType.DELETE -&gt; deleteFromFirebase(operation)</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private suspend fun performOperationLocally(operation: PendingOperations) {
<b class="nc">&nbsp;        when (operation.operationType) {</b>
<b class="nc">&nbsp;            OperationType.ADD -&gt; addToRoom(operation)</b>
<b class="nc">&nbsp;            OperationType.UPDATE -&gt; updateRoom(operation)</b>
<b class="nc">&nbsp;            OperationType.DELETE -&gt; deleteFromRoom(operation)</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private inline fun &lt;reified T : androidx.work.Worker&gt; enqueueWorker(tag: String) {
<b class="nc">&nbsp;        val workRequest = OneTimeWorkRequest.Builder(T::class.java)</b>
<b class="nc">&nbsp;            .addTag(tag)</b>
<b class="nc">&nbsp;            .build()</b>
<b class="nc">&nbsp;        WorkManager.getInstance(applicationContext)</b>
<b class="nc">&nbsp;            .enqueueUniqueWork(tag, ExistingWorkPolicy.REPLACE, workRequest)</b>
&nbsp;    }
&nbsp;
&nbsp;    private fun deleteOperation(operation: PendingOperations) {
<b class="nc">&nbsp;        CoroutineScope(Dispatchers.IO).launch {</b>
<b class="nc">&nbsp;            pendingOperations.deleteOperation(operation)</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private suspend fun addToFirebase(operation: PendingOperations) {
<b class="nc">&nbsp;        when (operation.dataType) {</b>
&nbsp;            &quot;event&quot; -&gt; {
<b class="nc">&nbsp;                val event = converters.toEvent(operation.data)</b>
<b class="nc">&nbsp;                eventDataMethods.saveEvent(event) { result, _ -&gt;</b>
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncEventsDataWorker&gt;(&quot;SyncEventsDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;invite&quot; -&gt; {
<b class="nc">&nbsp;                val invite = converters.toInvite(operation.data)</b>
<b class="nc">&nbsp;                inviteMethods.createInvite(invite) { result -&gt;</b>
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncInvitesDataWorker&gt;(&quot;SyncInvitesDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;attendee&quot; -&gt; {
<b class="nc">&nbsp;                val attendee = converters.toAttendee(operation.data)</b>
<b class="nc">&nbsp;                eventDataMethods.addAttendeeUpdatePeopleGoingCount(</b>
<b class="nc">&nbsp;                    attendee.eventId.toString(),</b>
<b class="nc">&nbsp;                    attendee.userId.toString()</b>
&nbsp;                ) { result -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncAttendeeDataWorker&gt;(&quot;SyncAttendeeDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;fav_event&quot; -&gt; {
<b class="nc">&nbsp;                eventDataMethods.addEventToUserFav(</b>
<b class="nc">&nbsp;                    operation.userId,</b>
<b class="nc">&nbsp;                    operation.eventId,</b>
&nbsp;                ) { result, _ -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncFavEventsDataWorker&gt;(&quot;SyncFavEventsDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private suspend fun updateFirebase(operation: PendingOperations) {
<b class="nc">&nbsp;        when (operation.dataType) {</b>
&nbsp;            &quot;event&quot; -&gt; {
<b class="nc">&nbsp;                val event = converters.toEvent(operation.data)</b>
<b class="nc">&nbsp;                eventDataMethods.updateEventById(event.eventId.toString(), event) { result -&gt;</b>
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncEventsDataWorker&gt;(&quot;SyncEventsDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;user&quot; -&gt; {
<b class="nc">&nbsp;                val user = converters.toUpdateUser(operation.data)</b>
<b class="nc">&nbsp;                userDataMethods.updateUserProfile(</b>
<b class="nc">&nbsp;                    user.userId.toString(),</b>
<b class="nc">&nbsp;                    user.userName.toString(),</b>
<b class="nc">&nbsp;                    user.userPhone.toString(),</b>
<b class="nc">&nbsp;                    user.userDob.toString(),</b>
<b class="nc">&nbsp;                    user.userImg.toString(),</b>
&nbsp;                ) { result -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncEventsDataWorker&gt;(&quot;SyncEventsDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;user_location&quot; -&gt; {
<b class="nc">&nbsp;                userDataMethods.updateUserLocation(operation.userId, operation.data) { result -&gt;</b>
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncUserDataWorker&gt;(&quot;SyncUserDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;user_profile_status&quot; -&gt; {
<b class="nc">&nbsp;                userDataMethods.updateUserProfileStatus(</b>
<b class="nc">&nbsp;                    operation.userId,</b>
<b class="nc">&nbsp;                    operation.data.toBoolean()</b>
&nbsp;                ) { result -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncUserDataWorker&gt;(&quot;SyncUserDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;user_notification_status&quot; -&gt; {
<b class="nc">&nbsp;                userDataMethods.updateUserNotificationSettings(</b>
<b class="nc">&nbsp;                    operation.userId,</b>
<b class="nc">&nbsp;                    operation.data.toBoolean()</b>
&nbsp;                ) { result -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncUserDataWorker&gt;(&quot;SyncUserDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;user_suspension_status&quot; -&gt; {
<b class="nc">&nbsp;                userDataMethods.updateUserBanStatus(</b>
<b class="nc">&nbsp;                    operation.userId,</b>
<b class="nc">&nbsp;                    operation.data.toBoolean()</b>
&nbsp;                ) { result -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncUserDataWorker&gt;(&quot;SyncUserDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;event_invite&quot; -&gt; {
<b class="nc">&nbsp;                inviteMethods.updateInviteStatus(</b>
<b class="nc">&nbsp;                    operation.documentId,</b>
<b class="nc">&nbsp;                    operation.data</b>
&nbsp;                ) { result -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncInvitesDataWorker&gt;(&quot;SyncInvitesDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;event_status&quot; -&gt; {
<b class="nc">&nbsp;                eventDataMethods.updateEventStatusById(</b>
<b class="nc">&nbsp;                    operation.documentId,</b>
<b class="nc">&nbsp;                    operation.data</b>
&nbsp;                ) { result -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncFavEventsDataWorker&gt;(&quot;SyncFavEventsDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private suspend fun deleteFromFirebase(operation: PendingOperations) {
<b class="nc">&nbsp;        when (operation.dataType) {</b>
&nbsp;            &quot;event&quot; -&gt; {
<b class="nc">&nbsp;                val event = converters.toEvent(operation.data)</b>
<b class="nc">&nbsp;                eventDataMethods.deleteEventById(event.eventId.toString(), true) { result -&gt;</b>
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncEventsDataWorker&gt;(&quot;SyncEventsDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;invite&quot; -&gt; {
<b class="nc">&nbsp;                val invite = converters.toInvite(operation.data)</b>
<b class="nc">&nbsp;                inviteMethods.deleteInvite(</b>
<b class="nc">&nbsp;                    invite.eventId.toString(),</b>
<b class="nc">&nbsp;                    invite.receiverId.toString()</b>
&nbsp;                ) { result -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncInvitesDataWorker&gt;(&quot;SyncInvitesDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;fav_event&quot; -&gt; {
<b class="nc">&nbsp;                eventDataMethods.removeEventFromUserFav(</b>
<b class="nc">&nbsp;                    operation.userId,</b>
<b class="nc">&nbsp;                    operation.eventId</b>
&nbsp;                ) { result, _ -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncFavEventsDataWorker&gt;(&quot;SyncFavEventsDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            &quot;attendee&quot; -&gt; {
<b class="nc">&nbsp;                eventDataMethods.removeAttendeeUpdatePeopleGoingCount(</b>
<b class="nc">&nbsp;                    operation.eventId,</b>
<b class="nc">&nbsp;                    operation.userId</b>
&nbsp;                ) { result -&gt;
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        enqueueWorker&lt;SyncAttendeeDataWorker&gt;(&quot;SyncAttendeeDataWorker&quot;)</b>
<b class="nc">&nbsp;                        deleteOperation(operation)</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private suspend fun addToRoom(operation: PendingOperations) {
<b class="nc">&nbsp;        when (operation.dataType) {</b>
&nbsp;            &quot;user&quot; -&gt; {
<b class="nc">&nbsp;                val user = converters.toUser(operation.data)</b>
<b class="nc">&nbsp;                userDao.saveUserData(user)</b>
&nbsp;            }
&nbsp;
&nbsp;            &quot;event&quot; -&gt; {
<b class="nc">&nbsp;                val event = converters.toEvent(operation.data)</b>
<b class="nc">&nbsp;                eventDao.saveEvent(event)</b>
&nbsp;            }
&nbsp;
&nbsp;            &quot;invite&quot; -&gt; {
<b class="nc">&nbsp;                val invite = converters.toInvite(operation.data)</b>
<b class="nc">&nbsp;                invitesDao.createInvite(invite)</b>
&nbsp;            }
&nbsp;
&nbsp;            &quot;attendee&quot; -&gt; {
<b class="nc">&nbsp;                val attendee = converters.toAttendee(operation.data)</b>
<b class="nc">&nbsp;                attendeeDao.addAttendee(attendee)</b>
&nbsp;            }
&nbsp;
&nbsp;            &quot;fav_event&quot; -&gt; {
<b class="nc">&nbsp;                val favEvent = converters.toFavEvent(operation.data)</b>
<b class="nc">&nbsp;                favEventsDao.addEventToUserFav(favEvent)</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private suspend fun updateRoom(operation: PendingOperations) {
<b class="nc">&nbsp;        when (operation.dataType) {</b>
&nbsp;            &quot;user&quot; -&gt; {
<b class="nc">&nbsp;                val user = converters.toUser(operation.data)</b>
<b class="nc">&nbsp;                userDao.updateUserProfile(</b>
<b class="nc">&nbsp;                    user.userId.toString(),</b>
<b class="nc">&nbsp;                    user.userName.toString(),</b>
<b class="nc">&nbsp;                    user.userPhone.toString(),</b>
<b class="nc">&nbsp;                    user.userDob.toString(),</b>
<b class="nc">&nbsp;                    user.userImg.toString()</b>
&nbsp;                )
&nbsp;            }
&nbsp;
&nbsp;            &quot;event&quot; -&gt; {
<b class="nc">&nbsp;                val event = converters.toEvent(operation.data)</b>
<b class="nc">&nbsp;                eventDao.updateEventById(</b>
<b class="nc">&nbsp;                    eventTitle = event.eventTitle,</b>
<b class="nc">&nbsp;                    eventOrganizer = event.eventOrganizer,</b>
<b class="nc">&nbsp;                    eventTiming = event.eventTiming,</b>
<b class="nc">&nbsp;                    eventCategory = event.eventCategory,</b>
<b class="nc">&nbsp;                    eventDescription = event.eventDescription,</b>
<b class="nc">&nbsp;                    eventLocation = event.eventLocation,</b>
<b class="nc">&nbsp;                    eventLong = event.eventLong,</b>
<b class="nc">&nbsp;                    eventLat = event.eventLat,</b>
<b class="nc">&nbsp;                    eventDate = event.eventDate,</b>
<b class="nc">&nbsp;                    isEventFeatured = event.isEventFeatured,</b>
<b class="nc">&nbsp;                    isEventPopular = event.isEventPopular,</b>
<b class="nc">&nbsp;                    numberOfPeopleAttending = event.numberOfPeopleAttending,</b>
<b class="nc">&nbsp;                    isEventPublic = event.isEventPublic,</b>
<b class="nc">&nbsp;                    eventStatus = event.eventStatus,</b>
<b class="nc">&nbsp;                    eventCreatedBy = event.eventCreatedBy,</b>
<b class="nc">&nbsp;                    isEventDeleted = event.isEventDeleted,</b>
<b class="nc">&nbsp;                    eventId = event.eventId.toString()</b>
&nbsp;                )
&nbsp;            }
&nbsp;
&nbsp;            &quot;user_profile_status&quot; -&gt; {
<b class="nc">&nbsp;                userDao.updateUserProfileStatus(</b>
<b class="nc">&nbsp;                    operation.userId,</b>
<b class="nc">&nbsp;                    operation.data.toBoolean()</b>
&nbsp;                )
&nbsp;            }
&nbsp;
&nbsp;            &quot;user_location&quot; -&gt; {
<b class="nc">&nbsp;                userDao.updateUserLocation(</b>
<b class="nc">&nbsp;                    operation.userId,</b>
<b class="nc">&nbsp;                    operation.data</b>
&nbsp;                )
&nbsp;            }
&nbsp;
&nbsp;            &quot;user_notification_status&quot; -&gt; {
<b class="nc">&nbsp;                userDao.updateUserNotificationSettings(</b>
<b class="nc">&nbsp;                    operation.userId,</b>
<b class="nc">&nbsp;                    operation.data.toBoolean()</b>
&nbsp;                )
&nbsp;            }
&nbsp;
&nbsp;            &quot;user_suspension_status&quot; -&gt; {
<b class="nc">&nbsp;                userDao.updateUserBanStatus(</b>
<b class="nc">&nbsp;                    operation.userId,</b>
<b class="nc">&nbsp;                    operation.data.toBoolean()</b>
&nbsp;                )
&nbsp;            }
&nbsp;
&nbsp;            &quot;event_invite&quot; -&gt; {
<b class="nc">&nbsp;                val invite = converters.toInvite(operation.data)</b>
<b class="nc">&nbsp;                invitesDao.updateInviteStatus(</b>
<b class="nc">&nbsp;                    invite.inviteId.toString(),</b>
<b class="nc">&nbsp;                    invite.inviteStatus.toString()</b>
&nbsp;                )
&nbsp;            }
&nbsp;
&nbsp;            &quot;event_status&quot; -&gt; {
<b class="nc">&nbsp;                invitesDao.updateInviteStatus(</b>
<b class="nc">&nbsp;                    operation.documentId,</b>
<b class="nc">&nbsp;                    operation.data</b>
&nbsp;                )
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private suspend fun deleteFromRoom(operation: PendingOperations) {
<b class="nc">&nbsp;        when (operation.dataType) {</b>
&nbsp;            &quot;user&quot; -&gt; {
<b class="nc">&nbsp;                userDao.deleteUser(operation.userId)</b>
&nbsp;            }
&nbsp;
&nbsp;            &quot;event&quot; -&gt; {
<b class="nc">&nbsp;                eventDao.deleteEventById(operation.eventId)</b>
&nbsp;            }
&nbsp;
&nbsp;            &quot;invite&quot; -&gt; {
<b class="nc">&nbsp;                invitesDao.deleteInvite(operation.eventId, operation.userId)</b>
&nbsp;            }
&nbsp;
&nbsp;            &quot;attendee&quot; -&gt; {
<b class="nc">&nbsp;                attendeeDao.removeAttendee(operation.userId,operation.eventId)</b>
&nbsp;            }
&nbsp;
&nbsp;            &quot;fav_event&quot; -&gt; {
<b class="nc">&nbsp;                Log.d(</b>
<b class="nc">&nbsp;                    &quot;FavEventToBeRemoved&quot;,</b>
<b class="nc">&nbsp;                    &quot;deleteFromRoom: ${operation.userId} ${operation.eventId}&quot;</b>
&nbsp;                )
<b class="nc">&nbsp;                favEventsDao.removeEventFromUserFav(operation.userId, operation.eventId)</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-09-10 18:49</div>
</div>
</body>
</html>
