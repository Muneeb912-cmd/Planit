


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > EventInviteActivity</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.example.eventmanagement.ui.activities.event_invites</a>
</div>

<h1>Coverage Summary for Class: EventInviteActivity (com.example.eventmanagement.ui.activities.event_invites)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">EventInviteActivity</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/15)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/83)
  </span>
</td>
</tr>
  <tr>
    <td class="name">EventInviteActivity$observeInviteEvents$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$observeInviteEvents$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$onAcceptIconClick$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$onEventCardClick$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$onEventCardClick$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$onRejectIconClick$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$setupTabLayout$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$showEventDetailsBottomSheet$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$special$$inlined$viewModels$default$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$special$$inlined$viewModels$default$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$special$$inlined$viewModels$default$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$special$$inlined$viewModels$default$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$special$$inlined$viewModels$default$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">EventInviteActivity$special$$inlined$viewModels$default$6</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/32)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/112)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.example.eventmanagement.ui.activities.event_invites
&nbsp;
&nbsp;import android.os.Bundle
&nbsp;import android.util.Log
&nbsp;import android.view.View
&nbsp;import android.widget.Toast
&nbsp;import androidx.activity.viewModels
&nbsp;import androidx.appcompat.app.AppCompatActivity
&nbsp;import androidx.lifecycle.lifecycleScope
&nbsp;import androidx.recyclerview.widget.LinearLayoutManager
&nbsp;import com.example.eventmanagement.adapters.EventInviteAdapter
&nbsp;import com.example.eventmanagement.databinding.ActivityEventInviteBinding
&nbsp;import com.example.eventmanagement.models.EventData
&nbsp;import com.example.eventmanagement.models.EventInvites
&nbsp;import com.example.eventmanagement.ui.bottom_sheet_dialogs.event_details.event_details.EventDetailsFragment
&nbsp;import com.example.eventmanagement.ui.shared_view_model.SharedViewModel
&nbsp;import com.google.android.material.tabs.TabLayout
&nbsp;import dagger.hilt.android.AndroidEntryPoint
&nbsp;import kotlinx.coroutines.launch
&nbsp;
&nbsp;@AndroidEntryPoint
<b class="nc">&nbsp;class EventInviteActivity : AppCompatActivity(), EventInviteAdapter.EventCardClickListener {</b>
&nbsp;
&nbsp;    private lateinit var binding: ActivityEventInviteBinding
<b class="nc">&nbsp;    private val sharedViewModel: SharedViewModel by viewModels()</b>
<b class="nc">&nbsp;    private val viewModel: EventInviteViewModel by viewModels()</b>
&nbsp;    private var isEventDetailsBottomSheetShown = false
&nbsp;    private var currentTabPosition = 0
&nbsp;    private lateinit var adapter: EventInviteAdapter
&nbsp;
&nbsp;    override fun onCreate(savedInstanceState: Bundle?) {
<b class="nc">&nbsp;        super.onCreate(savedInstanceState)</b>
<b class="nc">&nbsp;        binding = ActivityEventInviteBinding.inflate(layoutInflater)</b>
<b class="nc">&nbsp;        setContentView(binding.root)</b>
<b class="nc">&nbsp;        setupTabLayout()</b>
<b class="nc">&nbsp;        setupRecyclerView()</b>
<b class="nc">&nbsp;        observeInviteEvents()</b>
&nbsp;
<b class="nc">&nbsp;        binding.toolBar.setNavigationOnClickListener {</b>
<b class="nc">&nbsp;            finish()</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private fun observeInviteEvents() {
<b class="nc">&nbsp;        lifecycleScope.launch {</b>
<b class="nc">&nbsp;            sharedViewModel.currentUserInvites.collect { eventInvites -&gt;</b>
<b class="nc">&nbsp;                Log.d(&quot;EventInvites&quot;, &quot;observeInviteEvents: $eventInvites&quot;)</b>
<b class="nc">&nbsp;                handleInviteVisibility(eventInvites.isEmpty())</b>
<b class="nc">&nbsp;                updateTabTitles(eventInvites)</b>
<b class="nc">&nbsp;                filterEvents(currentTabPosition)</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    private fun setupTabLayout() {
<b class="nc">&nbsp;        binding.tabLayout.addOnTabSelectedListener(object : TabLayout.OnTabSelectedListener {</b>
&nbsp;            override fun onTabSelected(tab: TabLayout.Tab?) {
<b class="nc">&nbsp;                tab?.let {</b>
<b class="nc">&nbsp;                    currentTabPosition = it.position</b>
<b class="nc">&nbsp;                    filterEvents(it.position)</b>
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            override fun onTabUnselected(tab: TabLayout.Tab?) {}</b>
&nbsp;            override fun onTabReselected(tab: TabLayout.Tab?) {
<b class="nc">&nbsp;                tab?.let {</b>
<b class="nc">&nbsp;                    filterEvents(it.position)</b>
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;        })
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    private fun filterEvents(selectedTabPosition: Int) {
<b class="nc">&nbsp;        val status = when (selectedTabPosition) {</b>
<b class="nc">&nbsp;            0 -&gt; &quot;pending&quot;</b>
<b class="nc">&nbsp;            1 -&gt; &quot;accepted&quot;</b>
<b class="nc">&nbsp;            2 -&gt; &quot;expired&quot;</b>
<b class="nc">&nbsp;            else -&gt; null</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        val filteredEvents = sharedViewModel.currentUserInvites.value.filter { invite -&gt;</b>
<b class="nc">&nbsp;            status == null || invite.inviteStatus == status</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        adapter.updateData(filteredEvents)</b>
<b class="nc">&nbsp;        handleInviteVisibility(filteredEvents.isEmpty(), selectedTabPosition)</b>
&nbsp;    }
&nbsp;
&nbsp;    private fun handleInviteVisibility(
&nbsp;        isEmpty: Boolean,
<b class="nc">&nbsp;        selectedTabPosition: Int = currentTabPosition</b>
&nbsp;    ) {
<b class="nc">&nbsp;        if (isEmpty) {</b>
<b class="nc">&nbsp;            binding.invitesList.visibility = View.GONE</b>
<b class="nc">&nbsp;            binding.noInvitesTv.visibility = View.VISIBLE</b>
&nbsp;
<b class="nc">&nbsp;            binding.noInvitesTv.text = when (selectedTabPosition) {</b>
<b class="nc">&nbsp;                0 -&gt; &quot;No pending invites.&quot;</b>
<b class="nc">&nbsp;                1 -&gt; &quot;No accepted invites.&quot;</b>
<b class="nc">&nbsp;                2 -&gt; &quot;No expired invites.&quot;</b>
<b class="nc">&nbsp;                else -&gt; &quot;No invites available.&quot;</b>
&nbsp;            }
&nbsp;        } else {
<b class="nc">&nbsp;            binding.invitesList.visibility = View.VISIBLE</b>
<b class="nc">&nbsp;            binding.noInvitesTv.visibility = View.GONE</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private fun setupRecyclerView() {
<b class="nc">&nbsp;        adapter = EventInviteAdapter(emptyList(), this)</b>
<b class="nc">&nbsp;        binding.invitesList.layoutManager =</b>
<b class="nc">&nbsp;            LinearLayoutManager(this, LinearLayoutManager.VERTICAL, false)</b>
<b class="nc">&nbsp;        binding.invitesList.adapter = adapter</b>
&nbsp;    }
&nbsp;
&nbsp;    private fun updateTabTitles(eventInvites: List&lt;EventInvites&gt;) {
<b class="nc">&nbsp;        val pendingCount = eventInvites.count { it.inviteStatus == &quot;pending&quot; }</b>
<b class="nc">&nbsp;        val acceptedCount = eventInvites.count { it.inviteStatus == &quot;accepted&quot; }</b>
<b class="nc">&nbsp;        val expiredCount = eventInvites.count { it.inviteStatus == &quot;expired&quot; }</b>
&nbsp;
<b class="nc">&nbsp;        binding.tabLayout.getTabAt(0)?.text = &quot;Pending ($pendingCount)&quot;</b>
<b class="nc">&nbsp;        binding.tabLayout.getTabAt(1)?.text = &quot;Accepted ($acceptedCount)&quot;</b>
<b class="nc">&nbsp;        binding.tabLayout.getTabAt(2)?.text = &quot;Expired ($expiredCount)&quot;</b>
&nbsp;    }
&nbsp;
&nbsp;    override fun onEventCardClick(invite: EventInvites) {
<b class="nc">&nbsp;        lifecycleScope.launch {</b>
<b class="nc">&nbsp;            sharedViewModel.currentUserInvitedEvents.collect { events -&gt;</b>
<b class="nc">&nbsp;                events.firstOrNull { it.eventId == invite.eventId }?.let { event -&gt;</b>
<b class="nc">&nbsp;                    showEventDetailsBottomSheet(event)</b>
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private fun showEventDetailsBottomSheet(event: EventData) {
<b class="nc">&nbsp;        if (!isEventDetailsBottomSheetShown) {</b>
<b class="nc">&nbsp;            isEventDetailsBottomSheetShown = true</b>
<b class="nc">&nbsp;            val bottomSheetFragment = EventDetailsFragment(event)</b>
<b class="nc">&nbsp;            bottomSheetFragment.show(supportFragmentManager, bottomSheetFragment.tag)</b>
<b class="nc">&nbsp;            bottomSheetFragment.setOnDismissListener {</b>
<b class="nc">&nbsp;                isEventDetailsBottomSheetShown = false</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    override fun onAcceptIconClick(invite: EventInvites) {
<b class="nc">&nbsp;        viewModel.updateInviteStatus(invite.inviteId.toString(), &quot;accepted&quot;) { result, msg -&gt;</b>
<b class="nc">&nbsp;            showToast(if (result) &quot;Invite Accepted!&quot; else msg)</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    override fun onRejectIconClick(invite: EventInvites) {
<b class="nc">&nbsp;        viewModel.updateInviteStatus(invite.inviteId.toString(), &quot;rejected&quot;) { result, msg -&gt;</b>
<b class="nc">&nbsp;            showToast(if (result) &quot;Invite Rejected&quot; else msg)</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private fun showToast(message: String) {
<b class="nc">&nbsp;        Toast.makeText(this, message, Toast.LENGTH_SHORT).show()</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-09-09 23:10</div>
</div>
</body>
</html>
